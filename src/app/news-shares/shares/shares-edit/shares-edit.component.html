<div class="g-modal-bg create-shares" *ngIf="isForm">

    <div class="create-shares__cls-area" (click)="close.emit()"></div>

    <form class="create-shares__container"
        [formGroup]="form"
        (ngSubmit)="onSave(form)">

        <button class="create-shares__cls-btn btn-cls" (click)="close.emit()"><span></span></button>
        <button class="create-shares__cls-success btn-success" (click)="close.emit()"><span></span></button>

        <h2 class="create-shares__typografy-title">Добавить акцию</h2>
        <!-- <p class="shares-edit-form__typografy-date">{{dateNow}}</p> -->

        <div class="create-shares__wrap create-shares__wrap_main create-shares__wrap_path">

            <h3 class="create-shares__typografy-title create-shares__typografy-title_in-path">Основная информация</h3>

            <div class="create-shares__wrap create-shares__wrap_input create-shares__wrap_full">
                <ghm-textarea [formControlName]="'name'"
                    class="create-shares__input create-shares__input_area create-shares__input_title"
                    [ngClass]="{'invalid-value': form.get('name').invalid && form.get('name').dirty}"
                    [placeholder]="'Заголовок'"
                    [invalid]="form.get('name').invalid && form.get('name').dirty ? true : false">
                </ghm-textarea>
                <p class="create-shares__typografy-error">Поле обязательно для заполнения</p>
            </div>
            <div class="create-shares__wrap create-shares__wrap_input create-shares__wrap_full">
                <!-- <p class="create-shares__typografy-subtitle_add-link">Вставить ссылку</p> -->
                <ghm-textarea [formControlName]="'text'"
                    class="create-shares__input create-shares__input_area"
                    [ngClass]="{'invalid-value': form.get('text').invalid && form.get('text').dirty}"
                    [placeholder]="'Краткое описание'"
                    [link]="true"
                    [invalid]="form.get('text').invalid && form.get('text').dirty ? true : false">
                </ghm-textarea>
                <p class="create-shares__typografy-error">Поле обязательно для заполнения</p>
            </div>
            
            <div class="create-shares__wrap create-shares__wrap_input create-shares__wrap_w2">
                <p class="create-shares__typografy-subtitle create-shares__typografy-subtitle_placeholder">Дата публикации</p>
                <div class="create-shares__input create-shares__input_datepicker">
                    <app-ghm-date-picker [formControlName]="'created_at'"></app-ghm-date-picker>
                </div>
            </div>
            <div class="create-shares__wrap create-shares__wrap_select create-shares__wrap_input create-shares__wrap_w2">
                <p class="create-shares__typografy-subtitle create-shares__typografy-subtitle_placeholder">Статус</p>
                <select name="status" class="create-shares__input create-shares__input_status">
                    <option>Черновик</option>
                    <option>Чистовик</option>
                    <option>Шаблон</option>
                </select>
            </div>
            
            <div class="create-shares__wrap create-shares__wrap_input create-shares__wrap_w2">
                <p class="create-shares__typografy-subtitle create-shares__typografy-subtitle_placeholder">Срок акции до</p>
                <div class="create-shares__input create-shares__input_datepicker">
                    <app-ghm-date-picker [formControlName]="'finish_date'"></app-ghm-date-picker>
                </div>
            </div>
            <div class="create-shares__wrap create-shares__wrap_checkbox create-shares__wrap_w2">
                <label class="g-checkbox">
                    <input type="checkbox" name="countdown" id="countdown" [formControlName]="'countdown'">
                    <div></div>
                    <span>Обратный отсчет</span>
                </label>
            </div>

            <div class="create-shares__wrap create-shares__wrap_preview create-shares__wrap_full">
                <div class="create-shares__wrap">
                    <div class="create-shares__btn create-shares__btn_photo-preview" (click)="mainImgPicker.click()">
                        <span>Загрузить фото</span>
                        <input [style.display]="'none'"
                            type="file"
                            #mainImgPicker
                            (change)="onImagePicked($event, 'main-image')">
                    </div>

                    <div class="create-shares__image create-shares__image_preview" *ngIf="form.get('mainThumbnail').value">
                        <img class="shares-edit-form__cover"
                            [src]="uploadsPath + form.get('mainThumbnail').value"
                            [alt]="form.value.name">

                        <button class="create-shares__cls-preview">
                            <span></span>
                        </button>
                    </div>
                        
                </div>

                <p class="create-shares__typografy-subtitle create-shares__typografy-subtitle_preview">Загрузите фото для превью</p>
            </div>

            <div class="create-shares__wrap create-shares__wrap_full">
                <label class="g-checkbox">
                    <input type="checkbox" name="public" id="public" style="display: none;" [formControlName]="'show_on_main'">
                    <div></div>
                    <span>Показать акцию на главной</span>
                </label>
            </div>
        </div>

        <h3 class="create-shares__typografy-title create-shares__typografy-title_out-path">Основная информация</h3>

       <div class="shares-edit-form__path-wrap">

            <div formArrayName="body">
                <div *ngFor="let block of body.controls; index as i"
                     [ngSwitch]="block.value.blockType">

                    <app-shares-edit-description
                        [formControlName]="i"
                        *ngSwitchCase="'description'"
                        (remove)="removeBlock(i)">
                    </app-shares-edit-description>

                    <app-shares-edit-image
                        [formControlName]="i"
                        *ngSwitchCase="'image'"
                        (remove)="removeBlock(i)">
                    </app-shares-edit-image>

                    <app-shares-edit-list
                        [formControlName]="i"
                        *ngSwitchCase="'list'"
                        (remove)="removeBlock(i)">
                    </app-shares-edit-list>

                    <app-shares-edit-flats
                        [formControlName]="i"
                        *ngSwitchCase="'flats'"
                        (remove)="removeBlock(i)">
                    </app-shares-edit-flats>

                </div>
            </div>
        </div>

        <ul class="create-shares__wrap create-shares__wrap_elements">
            <li class="create-shares__btn create-shares__btn_title" (click)="addList()">Заголовок</li>
            <li class="create-shares__btn create-shares__btn_text" (click)="addDescription()">Текст</li>
            <li class="create-shares__btn create-shares__btn_image" (click)="singleImgPicker.click()">Изображение
                <input #singleImgPicker
                       [style.display]="'none'"
                       type="file"
                       (change)="onImagePicked($event, 'single-image')">
            </li>
            <li class="create-shares__btn create-shares__btn_flats" (click)="addFlats()">Квартиры по акции</li>
        </ul>

        <div class="create-shares__wrap create-shares__wrap_upld">
            <button class="create-shares__btn create-shares__btn_public btn_var-2">Опубликовать</button>
            <button type="submit" 
                [disabled]="form.invalid"
                [ngClass]="{ 'shares-edit-form__save_disabled': form.invalid }"
                class="create-shares__btn create-shares__btn_save">Сохранить и закрыть</button>
        </div>
    </form>
</div>


<!-- Модалка вставки ссылки -->

<!-- <section class="g-modal-bg g-modal-bg_for-link paste-link">

    <div class="paste-link__container">

        <button class="paste-link__btn paste-link__btn-close btn-cls"><span></span></button>

        <div class="paste-link__wrap">
            <p class="paste-link__subtitle">URL</p>
            <input type="text" class="paste-link__input">
        </div>
        <div class="paste-link__wrap">
            <p class="paste-link__subtitle">Текст</p>
            <input type="text" class="paste-link__input">
        </div>
        <div class="paste-link__wrap paste-link__wrap_for-checkbox">
            <label class="g-checkbox">
                <input type="checkbox">
                <div></div>
                <span>Открыть ссылку в новом табе</span>
            </label>
        </div>
        <div class="paste-link__wrap paste-link__wrap_for-btn">
            <button class="paste-link__btn paste-link__btn-success btn_var-2">Вставить ссылку</button>
            <button class="paste-link__btn paste-link__btn-cancel btn_var-2">Отменить</button>
        </div>
    </div>
</section> -->

<!-- /Модалка вставки ссылки -->
