<section class="g-modal-bg documentation" *ngIf="!close">

    <div class="documentation__container">
        
        <button class="documentation__close documentation__close_main btn-cls"><span></span></button>
        <button class="documentation__close documentation__close_success btn-success"></button>

        <h2 class="documentation__title documentation__title_out-path">Настройка «Документации»</h2>


        <div *ngIf="progressLoaded" class="admin-gallery_progress">
            <div class="admin-gallery_progress-title">Загрузка</div>
            <div class="admin-gallery_progress-info">{{progressCurrent}} из {{progressCount}}</div>
            <div class="admin-gallery_progress-line">
                <div [style.width.%]="((100 / progressCount) * progressCurrent)" class="admin-gallery_progress-line-inner"></div>
            </div>
        </div>
        
        <ul class="documentation__objects">
            <li class="documentation__object"
                *ngFor="let object of objectsList; let i = index; let last = last">

                <div class="documentation__object-wrap documentation__object-wrap_head">
                    <h3 class="documentation__object-title">Блок {{i + 1}}</h3>

                    <div class="documentation__object-wrap documentation__object-wrap_btn-head">
                        <button class="documentation__object-btn documentation__object-btn_controls btn-empty"
                            (click)="deleteObject(object._id)">Удалить
                        </button>
                        <button class="documentation__object-btn documentation__object-btn_controls btn-empty" *ngIf="i > 0">Вверх</button>
                        <button class="documentation__object-btn documentation__object-btn_controls btn-empty" *ngIf="!last">Вниз</button>
                    </div>
                </div>

                <div class="documentation__object-wrap documentation__object-wrap_title">

                    <ghm-textarea class="documentation__object-input"
                        [value]="object.title"
                        [placeholder]="'Заголовок'"
                        (change)="updateObjectTitle(object._id, $event.target.value)"></ghm-textarea>

                    <label class="btn-admin documentation__object-btn_load-file">
                        <input style='display: none;' type="file" (change)="fileUpload(object._id, $event)" placeholder="Upload file" accept=".pdf" multiple>
                        Загрузить документ
                    </label>
                </div>

                <ul class="documentation__object-content">
                    <li class="documentation__object-file upload-file"
                        *ngFor="let file of object.uploads">
                        <button class="upload-file__delete-btn" (click)="deleteFile(object._id, file)">
                            <span></span>
                        </button>
                        <a class="upload-file__file-name upload-file__file-name_admin"
                           target="_blank"
                           [href]="'/' + uploadsPath + file.name"
                           [attr.download]="file.originName">
                            {{file.originalName}}
                        </a>
                        <p class="upload-file__date">{{parseDate(file.created_at)}}</p>
                    </li>
                </ul>
            </li>
        </ul>

        <button class="documentation__btn documentation__btn_add-block"
            (click)="createObject()">Создать новый блок
        </button>

        <div class="documentation__wrap documentation__wrap_btn">
            <button class="documentation__success-btn documentation__success-btn_success btn_var-2">Сохранить и закрыть</button>
            <button class="documentation__success-btn documentation__success-btn_cancel">Отменить</button>
        </div>
    </div>

</section>
